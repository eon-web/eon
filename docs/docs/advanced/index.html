<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Advanced Samples |Â Eon.js Docs</title>
    <link rel="stylesheet" href="/index.css" />
    <link rel="stylesheet" href="/docs/assets/prism.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
    
    
</head>

<body>
    <header>
        <div class="left">
            <img src="/docs/assets/logo.svg" alt="Logo" id="logo" />
            <nav>
                
                <a href="/">Home</a>
                
                <a href="/about">About</a>
                
                <a href="https://github.com/eon-web/eon">GitHub</a>
                
                <a href="">Contact</a>
                
            </nav>
        </div>
    </header>
    <aside>
        
            <a href="/docs/dummy"></a>
        
            <a href="/docs/introduction">Introduction</a>
        
            <a href="/docs/advanced">Advanced Samples</a>
        
            <a href="/docs/debugging">Debugging</a>
        
            <a href="/docs/api">Core API</a>
        
            <a href="/docs/plugins">Plugins API</a>
        
    </aside>
    <main>
        <h1 class="title">Advanced Samples</h1>
        <h1 id="advanced-examples">Advanced Examples</h1>
<p>Here are some more advanced examples to help you up your game more quickly</p>
<h2 id="post-endpoint">POST endpoint</h2>
<p>You can create a POST endpoint using the <code>post</code> method.
As of version v1.12.0, POST paths now have an <code>onBody</code> method. This is like <code>hook</code>, but when the callback is invoked, the body is already available. You can use it like this:</p>
<pre data-lang="js"><code><span class="token keyword">const</span> eon <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'eonjs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Create a post path on /post</span>
eon<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/post'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onBody</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">You sent me </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="the-old-way">The old way</h3>
<p>This is how it was done in v1.11.x and earlier. <code>onBody</code> uses this method internally.</p>
<p>!&gt; Note that the body is received asynchronously and therefore the <code>hook</code> handler has to be used.</p>
<pre data-lang="js"><code><span class="token keyword">const</span> eon <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'eonjs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Create a post path on /post</span>
eon<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/post'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hook</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">// Listen for the arrival of the body</span>
    req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">,</span> <span class="token parameter">_</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token comment">// Send back a response</span>
        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">You sent me </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><h3 id="a-shorter-version">A shorter version</h3>
<p>Try it out with curl:</p>
<pre data-lang="bash"><code><span class="token function">curl</span> localhost:8080/post -d <span class="token string">'foo=bar&amp;baz=buzz'</span><span class="token punctuation">;</span> <span class="token builtin class-name">echo</span></code></pre><p>Output:</p>
<pre data-lang="txt"><code>You sent me: {"foo":"bar","baz":"buzz"}</code></pre><p>The endpoint can also handle JSON input:</p>
<pre data-lang="bash"><code><span class="token function">curl</span> localhost:8080/post -d <span class="token string">'{"foo":"bar","baz":"buzz"}'</span> -H <span class="token string">"content-type:application/json"</span><span class="token punctuation">;</span> <span class="token builtin class-name">echo</span></code></pre><p>Will result in the same output.</p>
<h2 id="own-server">Own Server</h2>
<p>As of v1.14.0, the <code>EonWebEngine</code> class is also callable, so you can pass it as a listener to <code>http</code>&#39;s <code>createServer</code> method. This is especially useful when you need your server to use <strong>SSL</strong>. In that case you could pass the <code>eon</code> instance to <code>https.createServer</code> instead of calling <code>eon.listen()</code>.</p>
<p>Ex.:</p>
<pre data-lang="js"><code><span class="token keyword">const</span> eon <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'eon'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

eon<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token parameter">_</span> <span class="token operator">=></span> <span class="token string">'hi'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>eon<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">,</span> <span class="token parameter">_</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Listening on http://localhost:8080/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
    </main>
</body>

</html>